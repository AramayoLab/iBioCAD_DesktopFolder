

I am making a chemical visualizer for macOS and iOS, if you search for a chemical name, CID, or a PDB you would be searching in the PubChem database or the RCSB protein databank respectively. My App parses these databanks and displays the molecule in AR or on OSX in a scenekit window. When I bind the atoms together, I use the SCNPhysicsBallSocketJoint with bodyA, anchorA, bodyB, anchorB...

REQUEST #1

BUT, my anchor point is wrong, and the bindings don't behave the way I want them to. If you look at my code and run things, eventually you should be able to see that a string of single bonds works like a scenekit rope would be expected to. I can send video of the RNA molecule snapping together from the elasticity of this rope.
Where my algorithm breaks down is that I can't get the Benzene like carbon loops to stay as rigid bonds. I have tried 2 things: 1 use hinge bond, 2 use subNode. My attempt to make the benzene rigid atoms led me to make an SCNNode to hold the benzene atoms and only making the physics body on the parent node, in hopes that the subnodes would automatically be part of the physics body (no physics body on the subnode). I can get the ball socket joint but the subnodes just pass through the other atoms which is not the correct behavior. The second issue is that binding the "rigidNode" to the other atoms needs me to set the anchor point on the "rigidNode" where the c4' atom is, instead I seem to have the wrong anchor point and can't seem to get the binding correct.

1. Can you help me add 5 SCNSphereNodes to a parent node and make the parent node physics body from those 5 nodes? is that the right way to make 5 spheres into a rigid structure?
targetScene.physicsWorld.addBehavior(singleBond(a:atom["O5'"]!, b:atom["C5'"]!, dist: 0.5, molecule:targetMolecule))
                    
                    let riboseSugar_rigidNode = multiAtomRigidNode(atoms:[atom["C4'"]!, atom["C3'"]!, atom["C2'"]!, atom["C1'"]!, atom["O4'"]!])
                    targetMolecule.addChildNode(riboseSugar_rigidNode)
                    
                    targetScene.physicsWorld.addBehavior(singleBondToRigid(a:atom["C5'"]!, b:atom["C4'"]!, rigid:riboseSugar_rigidNode, dist: 0.5, molecule:targetMolecule))
                    
                 


2. Can you help me bind the parent Node to the other atoms (C5' to the C4' of the ribose in a Guanine base pair specifically) because I am not getting the right anchor points
//CRITICAL TEST POINT... what is the correct place to put the physics joint.... atom_a to atom_b.. b is on the edge at (x,0,0)
        return SCNPhysicsBallSocketJoint(bodyA: sphereNode_a!.physicsBody!,
                                         anchorA: SCNVector3Make(-dist * atomicVertexToARCorrectionFactor, 0, 0),
                                         bodyB: rigid.physicsBody!,
                                         anchorB: SCNVector3Make(-(sphereNode_b?.position.x)! + deltaToA_unit.x*dist*atomicVertexToARCorrectionFactor,
                                                                 -(sphereNode_b?.position.y)! + deltaToA_unit.y*dist*atomicVertexToARCorrectionFactor,
                                                                 -(sphereNode_b?.position.z)! + deltaToA_unit.z*dist*atomicVertexToARCorrectionFactor))
                                         //anchorB: SCNVector3Make(dist * atomicVertexToARCorrectionFactor, 0, 0))






REQUEST #2


Using SCNPhysicsJoints and not being able to understand the documentation on the anchor point bindings
Not being able to reproduce proper electrostatics in the physics engine


3. please help me with the electrostatic radialGravity force between charged nodes as well as the similar base pair stacking of the pi orbitals 
3. Electro statics in the physics engine are not exactly usable in this context the way you guys programmed it. Magnetic fields only make charged object spin if they are moving. Electric fields pull charged objects.

I have only been able to get the + and - charged sphere objects to bind by adding velocity pulses in the physics loop to properly simulate the lorentz force between objects and then cutting off the force at a cutoff distance. This might be best served with radialGravityField but I couldn't get the set up correct. Adding an electric field to a charged sphere node object causes an explosion in the simulation, fields don't seem to be able to exclude the charged object's they are apart of, what is the proper way to simulate electrostatic attractive force with the Scenekit physics so I won't need to loop over objects? The end goal is to have the nucleic acid base pairs snap together, with the elastic energy of the ribose sugar backbone snapping together from the elastic stretch of it's current conformer data. The beauty is, just adding some atomic molecular coordinates in a rope like fashion to a piece of RNA causes the rope to snap together and quantum physics is made clear. For the first time in history we can fold RNA proper and on mobile ARKit. With that being said, I need electrostatic force in SceneKit but I also need to add a magnetic base pair stacking force that comes from the pi orbital systems stacking on the base pairs. They magnetically bind. What is the best way to do a radial gravity field to bind base pair pi orbital systems?